(()=>{var e={};e.id=188,e.ids=[188,220,636],e.modules={361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},2015:e=>{"use strict";e.exports=require("react")},2198:(e,r,a)=>{"use strict";a.d(r,{D:()=>i,N:()=>n});var t=a(8732),o=a(2015);let s=(0,o.createContext)({isDarkMode:!1,toggleTheme:()=>{}}),n=({children:e})=>{let[r,a]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{"dark"===localStorage.getItem("mood-pa-theme")&&(a(!0),document.documentElement.classList.add("dark"))},[]),(0,t.jsx)(s.Provider,{value:{isDarkMode:r,toggleTheme:()=>{a(e=>{let r=!e;return localStorage.setItem("mood-pa-theme",r?"dark":"light"),r?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),r})}},children:e})},i=()=>(0,o.useContext)(s)},2326:e=>{"use strict";e.exports=require("react-dom")},2537:e=>{"use strict";e.exports=import("firebase/storage")},2768:()=>{},3175:(e,r,a)=>{"use strict";a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>h,default:()=>m,getServerSideProps:()=>g,getStaticPaths:()=>x,getStaticProps:()=>p,reportWebVitals:()=>y,routeModule:()=>k,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>f});var o=a(3885),s=a(237),n=a(1413),i=a(9616),c=a.n(i),l=a(7522),d=a(6506),u=e([d]);d=(u.then?(await u)():u)[0];let m=(0,n.M)(d,"default"),p=(0,n.M)(d,"getStaticProps"),x=(0,n.M)(d,"getStaticPaths"),g=(0,n.M)(d,"getServerSideProps"),h=(0,n.M)(d,"config"),y=(0,n.M)(d,"reportWebVitals"),f=(0,n.M)(d,"unstable_getStaticProps"),b=(0,n.M)(d,"unstable_getStaticPaths"),j=(0,n.M)(d,"unstable_getStaticParams"),v=(0,n.M)(d,"unstable_getServerProps"),w=(0,n.M)(d,"unstable_getServerSideProps"),k=new o.PagesRouteModule({definition:{kind:s.A.PAGES,page:"/projetos",pathname:"/projetos",bundlePath:"",filename:""},components:{App:l.default,Document:c()},userland:d});t()}catch(e){t(e)}})},3373:(e,r,a)=>{"use strict";a.a(e,async(e,t)=>{try{a.d(r,{A:()=>m});var o=a(6551),s=a(6958),n=a(4337),i=e([o,s,n]);[o,s,n]=i.then?(await i)():i;let c={apiKey:process.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.NEXT_PUBLIC_FIREBASE_APP_ID},l=(0,o.initializeApp)(c),d=(0,s.getAuth)(l),u=(0,n.getFirestore)(l),m=function(){let e=async(e,r)=>{try{let a=(await (0,s.signInWithEmailAndPassword)(d,e,r)).user,t=await (0,n.getDoc)((0,n.doc)(u,"users",a.uid));if(!t.exists())return await (0,s.signOut)(d),{success:!1,message:"Dados de usu\xe1rio n\xe3o encontrados."};{let e=t.data();if(!e.aprovado)return await (0,s.signOut)(d),{success:!1,message:"Sua conta ainda n\xe3o foi aprovada por um administrador."};return await (0,n.updateDoc)((0,n.doc)(u,"users",a.uid),{ultimoAcesso:new Date}),{success:!0,user:{id:a.uid,email:a.email,nome:e.nome,perfil:e.perfil}}}}catch(r){console.error("Erro no login:",r);let e="Erro ao fazer login. Tente novamente.";return"auth/user-not-found"===r.code||"auth/wrong-password"===r.code?e="Email ou senha incorretos.":"auth/too-many-requests"===r.code&&(e="Muitas tentativas de login. Tente novamente mais tarde."),{success:!1,message:e}}},r=async(e,r,a)=>{try{let t=(0,n.query)((0,n.collection)(u,"users"),(0,n.where)("email","==",r));if(!(await (0,n.getDocs)(t)).empty)return{success:!1,message:"Este email j\xe1 est\xe1 em uso."};let o=(await (0,s.createUserWithEmailAndPassword)(d,r,a)).user;return await (0,n.setDoc)((0,n.doc)(u,"users",o.uid),{id:o.uid,nome:e,email:r,perfil:"usuario",dataCriacao:new Date,ultimoAcesso:new Date,aprovado:!1}),await (0,s.signOut)(d),{success:!0,message:"Registro realizado com sucesso! Sua conta ser\xe1 analisada por um administrador."}}catch(r){console.error("Erro no registro:",r);let e="Erro ao registrar. Tente novamente.";return"auth/email-already-in-use"===r.code?e="Este email j\xe1 est\xe1 em uso.":"auth/weak-password"===r.code?e="A senha \xe9 muito fraca. Use pelo menos 6 caracteres.":"auth/invalid-email"===r.code&&(e="Email inv\xe1lido."),{success:!1,message:e}}},a=async()=>{try{return await (0,s.signOut)(d),{success:!0}}catch(e){return console.error("Erro no logout:",e),{success:!1,message:"Erro ao fazer logout. Tente novamente."}}},t=async()=>{try{let e=(0,n.query)((0,n.collection)(u,"users"),(0,n.where)("aprovado","==",!1)),r=await (0,n.getDocs)(e),a=[];return r.forEach(e=>{a.push(e.data())}),{success:!0,usuarios:a}}catch(e){return console.error("Erro ao buscar usu\xe1rios pendentes:",e),{success:!1,message:"Erro ao buscar usu\xe1rios pendentes."}}},o=async e=>{try{return await (0,n.updateDoc)((0,n.doc)(u,"users",e),{aprovado:!0}),{success:!0}}catch(e){return console.error("Erro ao aprovar usu\xe1rio:",e),{success:!1,message:"Erro ao aprovar usu\xe1rio."}}},i=async e=>{try{return await (0,n.updateDoc)((0,n.doc)(u,"users",e),{aprovado:!1,rejeitado:!0}),{success:!0}}catch(e){return console.error("Erro ao rejeitar usu\xe1rio:",e),{success:!1,message:"Erro ao rejeitar usu\xe1rio."}}};return{login:e,registrar:r,logout:a,getUsuariosPendentes:t,aprovarUsuario:o,rejeitarUsuario:i}};t()}catch(e){t(e)}})},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},4337:e=>{"use strict";e.exports=import("firebase/firestore")},6506:(e,r,a)=>{"use strict";a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{default:()=>d});var o=a(8732),s=a(2015),n=a(4233),i=a(6647),c=a(3373),l=e([i,c]);function d(){let[e,r]=(0,s.useState)([]),[a,t]=(0,s.useState)(!0),[l,d]=(0,s.useState)({type:"",text:""}),[u,m]=(0,s.useState)(!1),[p,x]=(0,s.useState)(""),[g,h]=(0,s.useState)([]),[y,f]=(0,s.useState)({nome:"",tipo:"residencial",areaTerreno:"",areaConstruida:""}),[b,j]=(0,s.useState)([]);(0,n.useRouter)();let v=(0,i.A)();(0,c.A)();let w=()=>{m(!u),d({type:"",text:""})},k=e=>{let{name:r,value:a}=e.target;f({...y,[r]:"areaTerreno"===r||"areaConstruida"===r?parseFloat(a):a})},N=async a=>{if(a.preventDefault(),!y.nome||!y.areaTerreno||!y.areaConstruida)return void d({type:"error",text:"Preencha todos os campos obrigat\xf3rios."});try{t(!0);let a={...y,usuarioId:"user123"},o=await v.adicionarProjeto(a,b);o.success?(d({type:"success",text:"Projeto adicionado com sucesso!"}),f({nome:"",tipo:"residencial",areaTerreno:"",areaConstruida:""}),j([]),m(!1),r([...e,o.projeto])):d({type:"error",text:o.message})}catch(e){console.error("Erro ao adicionar projeto:",e),d({type:"error",text:"Erro ao adicionar projeto. Tente novamente."})}finally{t(!1)}},E=async a=>{if(confirm("Tem certeza que deseja excluir este projeto?"))try{t(!0);let o=await v.removerProjeto(a);o.success?(d({type:"success",text:"Projeto removido com sucesso!"}),r(e.filter(e=>e.id!==a))):d({type:"error",text:o.message})}catch(e){console.error("Erro ao remover projeto:",e),d({type:"error",text:"Erro ao remover projeto. Tente novamente."})}finally{t(!1)}};return(0,o.jsx)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900",children:(0,o.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,o.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,o.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Meus Projetos"}),(0,o.jsx)("button",{onClick:w,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:u?"Cancelar":"Novo Projeto"})]}),l.text&&(0,o.jsx)("div",{className:`mb-6 p-3 rounded ${"error"===l.type?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200":"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200"}`,children:l.text}),u&&(0,o.jsxs)("div",{className:"mb-8 bg-white p-6 rounded-lg shadow-md dark:bg-gray-800",children:[(0,o.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Novo Projeto"}),(0,o.jsxs)("form",{onSubmit:N,children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome do Projeto *"}),(0,o.jsx)("input",{type:"text",name:"nome",value:y.nome,onChange:k,placeholder:"Ex: Resid\xeancia Unifamiliar - Vila Santa Maria",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tipo de Projeto"}),(0,o.jsxs)("select",{name:"tipo",value:y.tipo,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[(0,o.jsx)("option",{value:"residencial",children:"Residencial"}),(0,o.jsx)("option",{value:"comercial",children:"Comercial"}),(0,o.jsx)("option",{value:"misto",children:"Misto"}),(0,o.jsx)("option",{value:"industrial",children:"Industrial"}),(0,o.jsx)("option",{value:"institucional",children:"Institucional"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"\xc1rea do Terreno (m\xb2) *"}),(0,o.jsx)("input",{type:"number",name:"areaTerreno",value:y.areaTerreno,onChange:k,placeholder:"Ex: 250",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,min:"1",step:"0.01"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"\xc1rea Constru\xedda (m\xb2) *"}),(0,o.jsx)("input",{type:"number",name:"areaConstruida",value:y.areaConstruida,onChange:k,placeholder:"Ex: 150",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:!0,min:"1",step:"0.01"})]}),(0,o.jsxs)("div",{className:"sm:col-span-2",children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Arquivos do Projeto"}),(0,o.jsx)("input",{type:"file",onChange:e=>{j(Array.from(e.target.files))},multiple:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Voc\xea pode enviar m\xfaltiplos arquivos (PDF, DWG, JPG, PNG)"})]})]}),(0,o.jsxs)("div",{className:"mt-6 flex justify-end",children:[(0,o.jsx)("button",{type:"button",onClick:w,className:"mr-3 px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",children:"Cancelar"}),(0,o.jsx)("button",{type:"submit",disabled:a,className:`px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors ${a?"opacity-70 cursor-not-allowed":""}`,children:a?"Enviando...":"Enviar Projeto"})]})]})]}),(0,o.jsx)("div",{className:"mb-6",children:(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{type:"text",placeholder:"Buscar projetos...",value:p,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}),(0,o.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),a&&0===e.length?(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsxs)("svg",{className:"mx-auto h-12 w-12 text-gray-400 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,o.jsx)("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Carregando projetos..."})]}):0===g.length?(0,o.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg shadow-md dark:bg-gray-800",children:[(0,o.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})}),(0,o.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nenhum projeto encontrado"}),(0,o.jsxs)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:[p?"Tente outro termo de busca ou ":"Comece a ",(0,o.jsx)("button",{type:"button",onClick:w,className:"text-blue-600 hover:text-blue-500 dark:text-blue-400",children:"adicione um novo projeto"})]})]}):(0,o.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow-md dark:bg-gray-800",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,o.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Nome"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Data"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Status"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Conformidade"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"A\xe7\xf5es"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:g.map(e=>(0,o.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,o.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.nome}),(0,o.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.tipo})]}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.data instanceof Date?e.data.toLocaleDateString("pt-BR"):new Date(1e3*e.data.seconds).toLocaleDateString("pt-BR")})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"An\xe1lise Conclu\xedda"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}`,children:e.status})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"Total"===e.conformidade?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"Parcial"===e.conformidade?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:e.conformidade})}),(0,o.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,o.jsx)("a",{href:`/projetos/${e.id}`,className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3",children:"Ver Relat\xf3rio"}),(0,o.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Excluir"})]})]},e.id))})]})})]})})})}[i,c]=l.then?(await l)():l,t()}catch(e){t(e)}})},6551:e=>{"use strict";e.exports=import("firebase/app")},6647:(e,r,a)=>{"use strict";a.a(e,async(e,t)=>{try{a.d(r,{A:()=>c});var o=a(2015),s=a(4337),n=a(2537),i=e([s,n]);function c(){let[e,r]=(0,o.useState)(!1),[a,t]=(0,o.useState)(null),i=(0,s.getFirestore)(),c=(0,n.getStorage)(),l=async e=>{try{r(!0),t(null);let a=(0,s.query)((0,s.collection)(i,"projetos"),(0,s.where)("usuarioId","==",e)),o=await (0,s.getDocs)(a),n=[];return o.forEach(e=>{n.push({id:e.id,...e.data()})}),{success:!0,projetos:n}}catch(e){return console.error("Erro ao obter projetos:",e),t("Erro ao carregar projetos. Tente novamente."),{success:!1,message:"Erro ao carregar projetos."}}finally{r(!1)}},d=async e=>{try{r(!0),t(null);let a=await (0,s.getDoc)((0,s.doc)(i,"projetos",e));if(!a.exists())return t("Projeto n\xe3o encontrado."),{success:!1,message:"Projeto n\xe3o encontrado."};{let r=(0,s.query)((0,s.collection)(i,"analises"),(0,s.where)("projetoId","==",e)),t=await (0,s.getDocs)(r),o=null;return t.empty||t.forEach(e=>{o={id:e.id,...e.data()}}),{success:!0,projeto:{id:a.id,...a.data(),analise:o}}}}catch(e){return console.error("Erro ao obter projeto:",e),t("Erro ao carregar projeto. Tente novamente."),{success:!1,message:"Erro ao carregar projeto."}}finally{r(!1)}},u=async(e,a=[])=>{try{r(!0),t(null);let o=[];if(a&&a.length>0)for(let e of a){let r=(0,n.ref)(c,`projetos/${Date.now()}_${e.name}`);await (0,n.uploadBytes)(r,e);let a=await (0,n.getDownloadURL)(r);o.push(a)}let l={...e,data:new Date,status:"Em An\xe1lise",conformidade:"Pendente",arquivosUrls:o},d=await (0,s.addDoc)((0,s.collection)(i,"projetos"),l),u=await x(d.id,l);return{success:!0,projeto:{id:d.id,...l,analise:u}}}catch(e){return console.error("Erro ao adicionar projeto:",e),t("Erro ao adicionar projeto. Tente novamente."),{success:!1,message:"Erro ao adicionar projeto."}}finally{r(!1)}},m=async(e,a,o=[])=>{try{r(!0),t(null);let l=await (0,s.getDoc)((0,s.doc)(i,"projetos",e));if(!l.exists())return t("Projeto n\xe3o encontrado."),{success:!1,message:"Projeto n\xe3o encontrado."};let d=l.data(),u=[...d.arquivosUrls||[]];if(o&&o.length>0)for(let e of o){let r=(0,n.ref)(c,`projetos/${Date.now()}_${e.name}`);await (0,n.uploadBytes)(r,e);let a=await (0,n.getDownloadURL)(r);u.push(a)}let m={...a,arquivosUrls:u};if(await (0,s.updateDoc)((0,s.doc)(i,"projetos",e),m),a.areaTerreno||a.areaConstruida){let r={...d,...a,arquivosUrls:u};await x(e,r)}return{success:!0}}catch(e){return console.error("Erro ao atualizar projeto:",e),t("Erro ao atualizar projeto. Tente novamente."),{success:!1,message:"Erro ao atualizar projeto."}}finally{r(!1)}},p=async e=>{try{r(!0),t(null);let a=(0,s.query)((0,s.collection)(i,"analises"),(0,s.where)("projetoId","==",e)),o=await (0,s.getDocs)(a),n=i.batch();return o.forEach(e=>{n.delete(e.ref)}),n.delete((0,s.doc)(i,"projetos",e)),await n.commit(),{success:!0}}catch(e){return console.error("Erro ao remover projeto:",e),t("Erro ao remover projeto. Tente novamente."),{success:!1,message:"Erro ao remover projeto."}}finally{r(!1)}},x=async(e,r)=>{try{let a={valor:parseFloat((6*Math.random()+2).toFixed(1)),minimo:5,conforme:!1};a.conforme=a.valor>=a.minimo;let t={valor:parseFloat((3*Math.random()+.5).toFixed(1)),minimo:1.5,conforme:!1};t.conforme=t.valor>=t.minimo;let o={valor:Math.round(r.areaConstruida/r.areaTerreno*100),maximo:70,conforme:!1};o.conforme=o.valor<=o.maximo;let n={valor:Math.round(30*Math.random()+10),minimo:20,conforme:!1};n.conforme=n.valor>=n.minimo;let c={valor:parseFloat((r.areaConstruida/r.areaTerreno).toFixed(2)),maximo:1.5,conforme:!1};c.conforme=c.valor<=c.maximo;let l={plantaBaixa:Math.random()>.1,cortes:Math.random()>.2,fachadas:Math.random()>.2,implantacao:Math.random()>.1,cobertura:Math.random()>.3,cotasNiveis:Math.random()>.3,escalas:Math.random()>.2,norte:Math.random()>.4},d=[];a.conforme||d.push("O recuo frontal est\xe1 abaixo do m\xednimo exigido pela legisla\xe7\xe3o municipal."),t.conforme||d.push("O recuo lateral est\xe1 abaixo do m\xednimo exigido pela legisla\xe7\xe3o municipal."),o.conforme||d.push("A taxa de ocupa\xe7\xe3o est\xe1 acima do m\xe1ximo permitido pela legisla\xe7\xe3o municipal."),n.conforme||d.push("A taxa de permeabilidade est\xe1 abaixo do m\xednimo exigido."),c.conforme||d.push("O coeficiente de aproveitamento est\xe1 acima do m\xe1ximo permitido pela legisla\xe7\xe3o municipal."),l.plantaBaixa||d.push("Falta planta baixa conforme exigido nas normas de representa\xe7\xe3o."),l.cortes||d.push("Faltam cortes conforme exigido nas normas de representa\xe7\xe3o."),l.fachadas||d.push("Faltam fachadas conforme exigido nas normas de representa\xe7\xe3o."),l.implantacao||d.push("Falta implanta\xe7\xe3o conforme exigido nas normas de representa\xe7\xe3o."),l.cobertura||d.push("Falta planta de cobertura conforme exigido nas normas de representa\xe7\xe3o."),l.cotasNiveis||d.push("Faltam cotas e n\xedveis conforme exigido nas normas de representa\xe7\xe3o."),l.escalas||d.push("Faltam escalas conforme exigido nas normas de representa\xe7\xe3o."),l.norte||d.push("Falta indica\xe7\xe3o do norte na implanta\xe7\xe3o.");let u=a.conforme&&t.conforme&&o.conforme&&n.conforme&&c.conforme,m=l.plantaBaixa&&l.cortes&&l.fachadas&&l.implantacao,p=u&&m?"Total":"Parcial",x={projetoId:e,data:new Date,parametros:{recuoFrontal:a,recuoLateral:t,taxaOcupacao:o,taxaPermeabilidade:n,coeficienteAproveitamento:c},representacaoGrafica:l,observacoes:d,conformidade:p},g=await (0,s.addDoc)((0,s.collection)(i,"analises"),x);return await (0,s.updateDoc)((0,s.doc)(i,"projetos",e),{status:"An\xe1lise Conclu\xedda",conformidade:p}),{id:g.id,...x}}catch(e){return console.error("Erro ao iniciar an\xe1lise:",e),null}};return{loading:e,error:a,getProjetos:l,getProjetoPorId:d,adicionarProjeto:u,atualizarProjeto:m,removerProjeto:p,iniciarAnalise:x}}[s,n]=i.then?(await i)():i,t()}catch(e){t(e)}})},6958:e=>{"use strict";e.exports=import("firebase/auth")},7522:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>s});var t=a(8732),o=a(2198);function s({Component:e,pageProps:r}){return(0,t.jsx)(o.N,{children:(0,t.jsx)(e,{...r})})}a(2768)},7910:e=>{"use strict";e.exports=require("stream")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},9021:e=>{"use strict";e.exports=require("fs")}};var r=require("../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[616,441],()=>a(3175));module.exports=t})();